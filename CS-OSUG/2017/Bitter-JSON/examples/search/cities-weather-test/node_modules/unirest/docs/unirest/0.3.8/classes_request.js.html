<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>classes/request.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="HashMap.html">HashMap</a><ul class='methods'><li data-type='method'><a href="HashMap.html#clear">clear</a></li><li data-type='method'><a href="HashMap.html#containsKey">containsKey</a></li><li data-type='method'><a href="HashMap.html#containsValue">containsValue</a></li><li data-type='method'><a href="HashMap.html#get">get</a></li><li data-type='method'><a href="HashMap.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="HashMap.html#put">put</a></li><li data-type='method'><a href="HashMap.html#putAll">putAll</a></li><li data-type='method'><a href="HashMap.html#remove">remove</a></li><li data-type='method'><a href="HashMap.html#size">size</a></li><li data-type='method'><a href="HashMap.html#toString">toString</a></li></ul></li><li><a href="Headers.html">Headers</a><ul class='methods'><li data-type='method'><a href="Headers.html#clear">clear</a></li><li data-type='method'><a href="Headers.html#containsKey">containsKey</a></li><li data-type='method'><a href="Headers.html#containsValue">containsValue</a></li><li data-type='method'><a href="Headers.html#get">get</a></li><li data-type='method'><a href="Headers.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="Headers.html#put">put</a></li><li data-type='method'><a href="Headers.html#putAll">putAll</a></li><li data-type='method'><a href="Headers.html#remove">remove</a></li><li data-type='method'><a href="Headers.html#size">size</a></li><li data-type='method'><a href="Headers.html#toString">toString</a></li></ul></li><li><a href="Query.html">Query</a><ul class='methods'><li data-type='method'><a href="Query.html#clear">clear</a></li><li data-type='method'><a href="Query.html#containsKey">containsKey</a></li><li data-type='method'><a href="Query.html#containsValue">containsValue</a></li><li data-type='method'><a href="Query.html#get">get</a></li><li data-type='method'><a href="Query.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="Query.html#put">put</a></li><li data-type='method'><a href="Query.html#putAll">putAll</a></li><li data-type='method'><a href="Query.html#remove">remove</a></li><li data-type='method'><a href="Query.html#size">size</a></li><li data-type='method'><a href="Query.html#toString">toString</a></li></ul></li><li><a href="Request.html">Request</a><ul class='methods'><li data-type='method'><a href="Request.html#hasHeader">hasHeader</a></li><li data-type='method'><a href="Request.html#hasQueryParameter">hasQueryParameter</a></li><li data-type='method'><a href="Request.html#header">header</a></li><li data-type='method'><a href="Request.html#headers">headers</a></li><li data-type='method'><a href="Request.html#qs">qs</a></li><li data-type='method'><a href="Request.html#query">query</a></li><li data-type='method'><a href="Request.html#queryString">queryString</a></li><li data-type='method'><a href="Request.html#set">set</a></li><li data-type='method'><a href="Request.html#setMashapeKey">setMashapeKey</a></li><li data-type='method'><a href="Request.html#toRequestOptions">toRequestOptions</a></li><li data-type='method'><a href="Request.html#type">type</a></li></ul></li><li><a href="Response.html">Response</a><ul class='methods'><li data-type='method'><a href="Response.html#cookie">cookie</a></li><li data-type='method'><a href="Response.html#type">type</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-compression_deflate.html">compression/deflate</a><ul class='methods'><li data-type='method'><a href="module-compression_deflate.html#.reader">reader</a></li></ul></li><li><a href="module-constants.html">constants</a></li><li><a href="module-marshals_body.html">marshals/body</a><ul class='methods'><li data-type='method'><a href="module-marshals_body.html#.marshal">marshal</a></li><li data-type='method'><a href="module-marshals_body.html#.unmarshal">unmarshal</a></li></ul></li><li><a href="module-marshals_cookies.html">marshals/cookies</a><ul class='methods'><li data-type='method'><a href="module-marshals_cookies.html#.marshal">marshal</a></li></ul></li><li><a href="module-marshals_form.html">marshals/form</a><ul class='methods'><li data-type='method'><a href="module-marshals_form.html#.marshal">marshal</a></li></ul></li><li><a href="module-marshals_headers.html">marshals/headers</a><ul class='methods'><li data-type='method'><a href="module-marshals_headers.html#.marshal">marshal</a></li><li data-type='method'><a href="module-marshals_headers.html#.unmarshal">unmarshal</a></li></ul></li><li><a href="module-marshals_json.html">marshals/json</a><ul class='methods'><li data-type='method'><a href="module-marshals_json.html#.marshal">marshal</a></li><li data-type='method'><a href="module-marshals_json.html#.unmarshal">unmarshal</a></li></ul></li><li><a href="module-marshals_query.html">marshals/query</a><ul class='methods'><li data-type='method'><a href="module-marshals_query.html#.marshal">marshal</a></li><li data-type='method'><a href="module-marshals_query.html#.unmarshal">unmarshal</a></li></ul></li><li><a href="module-utils.html">utils</a><ul class='methods'><li data-type='method'><a href="module-utils.html#.does">does</a></li><li data-type='method'><a href="module-utils.html#.is">is</a></li><li data-type='method'><a href="module-utils.html#.normalizeHeaderName">normalizeHeaderName</a></li><li data-type='method'><a href="module-utils.html#.setCharAt">setCharAt</a></li><li data-type='method'><a href="module-utils.html#.trim">trim</a></li><li data-type='method'><a href="module-utils.html#.uid">uid</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#StatusError">StatusError</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">classes/request.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// var Authentication = require('./authentication')
// var Fields = require('./fields')
var Query = require('./query')
var HashMap = require('./hashmap')
var Headers = require('./headers')
// var Cookies = require('./cookies')
var Constants = require('../constants')
var mime = require('mime')
var utils = require('../utils')

/**
 * Defines an object to provide client request information to the underlying client library.
 *
 * @class
 * @type {Object}
 * @author Nijiko Yonskai
 * @param {Object} options Request options object
 * @param {String} options.method Request method verb
 */
function Request (options) {
  options = options || {}

  /**
   * The request method verb.
   *
   * @member
   * @private
   * @type {String}
   */
  this._method = null

  /**
   * The request uri.
   *
   * @member
   * @private
   * @type {String}
   */
  this._uri = null

  /**
   * The request query hashmap.
   *
   * @member
   * @private
   * @type {Query}
   */
  this._query = new Query()

  // this._cookies = new Cookies()
  // this._authentication = new Authentication()

  /**
   * The request headers hashmap.
   *
   * @member
   * @private
   * @type {Headers}
   */
  this._headers = new Headers()

  // this._fields = new Fields()

  this.method(options.method || Constants.METHODS[0])
  this.uri(options.uri)
}

/**
 * Associates the specified value with the specified key in the {@link Request#_query} mapping.
 *
 * When an arity of one argument is passed, the specified argument is treated as a collection and passed
 * to {@link Query#putAll()}.
 *
 * @method
 * @param  {(Object|HeaderString|Query|HashMap)} key
 * @param  {Object} value
 * @return {this}
 */
Request.prototype.query = function query () {
  if (arguments.length === 0) {
    return this._query
  }

  this._query.put.apply(this._query, arguments)
  return this
}

/**
 * Returns original key if this map contains a mapping for the specified key with a case insensitive check,
 * otherwise returns false.
 *
 * @method
 * @override
 * @see Query#containsKey
 * @param  {String} key Specified key to evaluate existance of.
 * @return {String|Boolean}
 */
Request.prototype.hasQueryParameter = function hasQueryParameter (key) {
  return this._query.containsKey(key)
}

/**
 * Associates the specified value with the specified key in the {@link Request#_headers} mapping.
 *
 * When an arity of one argument is passed, the specified argument is treated as a collection and passed
 * to {@link Header#putAll()}.
 *
 * @method
 * @param  {(Object|HeaderString|Header|HashMap)} key
 * @param  {Object} value
 * @return {this}
 */
Request.prototype.header = function header () {
  if (arguments.length === 0) {
    return this._headers
  }

  this._headers.put.apply(this._headers, arguments)
  return this
}

/**
 * Returns original key if this map contains a mapping for the specified key with a case insensitive check,
 * otherwise returns false.
 *
 * @method
 * @override
 * @see Headers#containsKey
 * @param  {String} key Specified key to evaluate existance of.
 * @return {(String|Boolean)}
 */
Request.prototype.hasHeader = function hasHeader (key) {
  return this._headers.containsKey(key)
}

/**
 * Associates the specified value as the `Content-Type` header in the {@link Request#_headers} mapping.
 *
 * When type value does not contain a forward slash a mimetype lookup is done to get the appropriate
 * mimetype string using the mime module.
 *
 * @method
 * @param  {String} value Specified content type value
 * @return {this}
 */
Request.prototype.type = function type (value) {
  this.header('Content-Type', utils.does(type).contain('/') ? value : mime.lookup(value))
  return this
}

/**
 * Associates the specified value as the `X-Mashape-Authorization` header in the {@link Request#_headers} mapping.
 *
 * @param {String} value Mashape Application Key
 * @return {this}
 */
Request.prototype.setMashapeKey = function (value) {
  this.header('X-Mashape-Authorization', value)
  return this
}

/**
 * Alias for {@link Request#header}
 *
 * @method
 * @return {this}
 */
Request.prototype.headers = Request.prototype.header

/**
 * Alias for {@link Request#header}
 *
 * @method
 * @return {this}
 */
Request.prototype.set = Request.prototype.header

/**
 * Alias for {@link Request#query}
 *
 * @method
 * @return {this}
 */
Request.prototype.qs = Request.prototype.query

/**
 * Alias for {@link Request#query}
 *
 * @method
 * @return {this}
 */
Request.prototype.queryString = Request.prototype.query

/**
 * Returns a JSON representation of this object for the request library.
 *
 * @return {Object} JSON representation
 * @see {@link Request#end}
 */
Request.prototype.toRequestOptions = function toRequestOptions () {
  return {
    url: this._uri,
    timeout: this._timeout,
    qs: this._query.map,
    useQuerystring: this._useQuerystring,
    method: this._method,
    jar: this._cookies,
    headers: this._headers.map,
    body: this._body,
    form: this._form,
    formData: this._formData,
    multipart: this._multipart,
    gzip: this._gzip,
    json: this._json,
    encoding: this._encoding,
    jsonReviver: this._jsonReviver,
    preambleCRLF: this._preambleCRLF,
    postambleCRLF: this._postambleCRLF,
    followRedirect: this._followRedirect,
    followAllRedirects: this._followAllRedirects,
    maxRedirects: this._maxRedirects,
    pool: this._pool,
    proxy: this._proxy,
    tunnel: this._tunnel,
    localAddress: this._localAddress,
    proxyHeaderWhitelist: this._proxyHeaderWhitelist,
    proxyHeaderExclusiveList: this._proxyHeaderExclusivelist,
    auth: this._authentication,
    aws: this._aws,
    hawk: this._hawk,
    oauth: this._oauth,
    strictSSL: this._strictSSL,
    agentOptions: this._agentOptions,
    httpSignature: this._httpSignature
  }
}

// Generate aliased methods from the underlying request library.
Constants.REQUEST_OPTIONS.forEach(function (method) {
  var reference = method

  if (method.indexOf(':') !== -1) {
    method = method.split(':')
    reference = method[1]
    method = method[0]
  }

  Request.prototype[method] = function (value) {
    this['_' + reference] = value
    return this
  }
})

module.exports = Request</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-beta3</a> on Tue Mar 24 2015 21:28:06 GMT-0700 (PDT) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
